# Система онлайн-магазина

## Описание проекта
Разработана комплексная система интернет-торговли на языке C++, применяющая парадигмы объектно-ориентированного проектирования, умные указатели и базу данных PostgreSQL.

## Технологический стек
- **Язык программирования**: C++17 (компиляторы GCC/Clang)
- **Система управления базами данных**: PostgreSQL версии 12 и выше
- **Клиентская библиотека СУБД**: libpqxx версии 7.0+
- **Система сборки**: CMake 3.10+

## Архитектурная организация

### Классовая иерархия и отношения

#### Иерархия пользовательских ролей:
- **Пользователь системы** (абстрактный базовый класс с чистыми виртуальными методами)
- **Администратор** (полномочия на все операции в системе)
- **Менеджер магазина** (управление заказами и товарными запасами)
- **Клиент магазина** (управление персональными заказами и корзиной)

#### Сущности управления заказами:
- **Заказ** (центральная сущность торговой операции)
- **Позиция заказа** (составные элементы заказа, отношение композиции)
- **Платёжная операция** (финансовая составляющая заказа, отношение композиции)

#### Товарный каталог:
- **Товарная позиция** (информационная модель товара)

### Реализация принципов ООП

1. **Наследование и специализация**
   Классы `Администратор`, `Менеджер` и `Клиент` являются специализированными производными от базового класса `Пользователь`.

2. **Полиморфное поведение**
   Каждый производный класс переопределяет виртуальные методы базового класса, обеспечивая специфичное поведение для каждой роли.

3. **Композиция объектов**
   Сущности `ПозицияЗаказа` и `Платёж` являются составными частями объекта `Заказ` и управляются через `unique_ptr`.

4. **Агрегация коллекций**
   Объект `Пользователь` агрегирует коллекцию своих заказов через `shared_ptr`.

### Управление памятью через умные указатели

- `std::unique_ptr<ПозицияЗаказа>` — эксклюзивное владение элементами заказа
- `std::unique_ptr<Платёж>` — управление жизненным циклом платёжных операций
- `std::shared_ptr<Заказ>` — разделяемое владение заказами между пользователями и системой

### Использование алгоритмов STL и лямбда-выражений

В системе применяются:
- `std::copy_if` — фильтрация заказов по различным критериям (статус, дата, сумма)
- `std::accumulate` — агрегация данных (подсчёт общей стоимости, количества товаров)
- Лямбда-выражения — реализация политик доступа и бизнес-правил

## Интеграция с базой данных

### Схема реляционной базы данных

Основные таблицы:

| Таблица | Назначение |
|---------|------------|
| `учётные_записи` | Регистрационные данные пользователей |
| `товарный_каталог` | Информация о товарах и их наличии |
| `совершённые_заказы` | Основные данные о заказах |
| `состав_заказов` | Связь заказов с товарами и их количеством |
| `история_статусов` | Хронология изменения состояний заказов |
| `журнал_аудита` | Логирование всех значимых действий в системе |

### Шаблонный класс для работы с базой данных

```cpp
template<typename ResultType>
class ПодключениеКБазеДанных {
private:
    pqxx::connection соединение;
    std::unique_ptr<pqxx::transaction_base> текущаяТранзакция;
    
public:
    ПодключениеКБазеДанных(const std::string& строкаПодключения);
    ~ПодключениеКБазеДанных();
    
    // Выполнение запросов с возвратом результатов
    std::vector<std::vector<std::string>> выполнитьЗапрос(
        const std::string& sqlЗапрос);
    
    // Выполнение команд без возврата данных
    void выполнитьКоманду(const std::string& sqlКоманда);
    
    // Управление транзакциями
    void начатьТранзакцию();
    void подтвердитьТранзакцию();
    void откатитьТранзакцию();
    
    // Дополнительные методы
    bool проверитьСоединение() const;
    std::string получитьСтатусТранзакции() const;
};
